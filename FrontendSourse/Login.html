<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEALS EAT - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            
        }

        .nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }

        .nav-container {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .nav-button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-weight: 500;
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .nav-button.active {
            background: rgba(255, 255, 255, 0.4);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            margin-top: 40px;
            
        }

        .form-container {
            margin-top: 40px;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
             
        }

        .form-title {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 300;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group input.error {
            border-color: #e74c3c;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .form-row-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .submit-button {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            
        }

        .submit-button:hover:not(:disabled) {

            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .submit-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 5px;
            animation: fadeIn 0.3s ease;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            animation: slideDown 0.5s ease;
        }

        .api-error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            animation: slideDown 0.5s ease;
        }

        .password-strength {
            height: 4px;
            border-radius: 2px;
            margin-top: 5px;
            transition: all 0.3s ease;
            background: #e1e5e9;
        }

        .password-strength-fill {
            height: 100%;
            border-radius: 2px;
            transition: all 0.3s ease;
            width: 0%;
        }

        .password-weak .password-strength-fill {
            background: #e74c3c;
            width: 33%;
        }
        .password-medium .password-strength-fill {
            background: #f39c12;
            width: 66%;
        }
        .password-strong .password-strength-fill {
            background: #27ae60;
            width: 100%;
        }

        .password-hint {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        .login-form {
            border-top: 1px solid #e1e5e9;
            margin-top: 30px;
            padding-top: 30px;
        }

        .form-switch {

            text-align: center;
            margin-bottom: 20px;
        }

        .switch-button {
            background: none;
            border: none;
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
            font-size: 16px;
        }

        .switch-button:hover {
            color: #764ba2;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bmr-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
        }

        .bmr-value {
            font-size: 24px;
            font-weight: bold;
            color: #1976d2;
        }

       

       
       
    </style>
</head>
<body>
<div id="app">
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é -->
    <nav class="nav">
        <div class="nav-container">
            <button
                    @click="navigateTo('home')"
                    class="nav-button"
                    :class="{ active: currentPage === 'home' }"
            >
                üè† –ì–ª–∞–≤–Ω–∞—è
            </button>
            <button
                    @click="navigateTo('diary')"
                    class="nav-button"
                    :class="{ active: currentPage === 'diary' }"
                    v-if="isAuthenticated"
            >
                üìñ –î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è
            </button>
            <button
                    @click="navigateTo('auth')"
                    class="nav-button"
                    :class="{ active: currentPage === 'auth' }"
                    v-if="!isAuthenticated"
            >
                üìù –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            </button>
            <button
                    @click="handleLogout"
                    class="nav-button"
                    v-if="isAuthenticated"
            >
                üö™ –í—ã—Ö–æ–¥ ({{ currentUser?.username }})
            </button>
        </div>
    </nav>

    <div class="container">
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <transition name="fade">
            <div v-if="currentPage === 'auth'" class="form-container">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
                <transition name="fade">
                    <div v-if="successMessage" class="success-message">
                        {{ successMessage }}
                    </div>
                </transition>

                <transition name="fade">
                    <div v-if="apiError" class="api-error-message">
                        {{ apiError }}
                    </div>
                </transition>

                <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ–∂–¥—É –≤—Ö–æ–¥–æ–º –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π -->
                <div class="form-switch">
                    <button
                            @click="toggleAuthMode"
                            class="switch-button"
                    >
                        {{ isLoginMode ? '–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è' : '–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏' }}
                    </button>
                </div>

                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                <div v-if="isLoginMode">
                    <h2 class="form-title">–í—Ö–æ–¥ –≤ HEALS EAT</h2>

                    <form @submit.prevent="handleLogin">
                        <div class="form-group">
                            <label>Email –∏–ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *</label>
                            <input
                                    type="text"
                                    v-model="loginForm.login"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ email –∏–ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
                                    required
                                    :class="{ error: loginErrors.login }"
                            >
                            <transition name="fade">
                                <div v-if="loginErrors.login" class="error-message">
                                    {{ loginErrors.login }}
                                </div>
                            </transition>
                        </div>

                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å *</label>
                            <input
                                    type="password"
                                    v-model="loginForm.password"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                                    required
                                    :class="{ error: loginErrors.password }"
                            >
                            <transition name="fade">
                                <div v-if="loginErrors.password" class="error-message">
                                    {{ loginErrors.password }}
                                </div>
                            </transition>
                        </div>

                        <button
                                type="submit"
                                class="submit-button"
                                :disabled="isSubmitting"
                        >
                            {{ isSubmitting ? '–í—Ö–æ–¥...' : '–í–æ–π—Ç–∏' }}
                            <span v-if="isSubmitting" class="loading-spinner"></span>
                        </button>
                    </form>
                </div>

                <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                <div v-else>
                    <h2 class="form-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ HEALS EAT</h2>

                    <form @submit.prevent="handleRegistration">
                        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                        <div class="form-group">
                            <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *</label>
                            <input
                                    type="text"
                                    v-model="registerForm.username"
                                    placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
                                    required
                                    :class="{ error: registerErrors.username }"
                                    @blur="validateField('username')"
                                    @input="clearError('username')"
                            >
                            <transition name="fade">
                                <div v-if="registerErrors.username" class="error-message">
                                    {{ registerErrors.username }}
                                </div>
                            </transition>
                        </div>

                        <div class="form-group">
                            <label>Email *</label>
                            <input
                                    type="email"
                                    v-model="registerForm.email"
                                    placeholder="your@email.com"
                                    required
                                    :class="{ error: registerErrors.email }"
                                    @blur="validateField('email')"
                                    @input="clearError('email')"
                            >
                            <transition name="fade">
                                <div v-if="registerErrors.email" class="error-message">
                                    {{ registerErrors.email }}
                                </div>
                            </transition>
                        </div>

                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å *</label>
                            <input
                                    type="password"
                                    v-model="registerForm.password"
                                    placeholder="–ù–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤"
                                    required
                                    :class="{ error: registerErrors.password }"
                                    @input="handlePasswordInput"
                                    @blur="validateField('password')"
                            >

                            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è -->
                            <div v-if="registerForm.password" class="password-strength" :class="passwordStrengthClass">
                                <div class="password-strength-fill"></div>
                            </div>

                            <div v-if="registerForm.password" class="password-hint">
                                –°–∏–ª–∞ –ø–∞—Ä–æ–ª—è: {{ passwordStrengthText }}
                            </div>

                            <transition name="fade">
                                <div v-if="registerErrors.password" class="error-message">
                                    {{ registerErrors.password }}
                                </div>
                            </transition>
                        </div>

                        <div class="form-group">
                            <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å *</label>
                            <input
                                    type="password"
                                    v-model="registerForm.confirmPassword"
                                    placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                                    required
                                    :class="{ error: registerErrors.confirmPassword }"
                                    @blur="validateField('confirmPassword')"
                                    @input="clearError('confirmPassword')"
                            >
                            <transition name="fade">
                                <div v-if="registerErrors.confirmPassword" class="error-message">
                                    {{ registerErrors.confirmPassword }}
                                </div>
                            </transition>
                        </div>

                        <!-- –§–∏–∑–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
                        <div class="form-row">
                            <div class="form-group">
                                <label>–í–æ–∑—Ä–∞—Å—Ç</label>
                                <input
                                        type="number"
                                        v-model.number="registerForm.age"
                                        placeholder="–ª–µ—Ç"
                                        min="1"
                                        max="120"
                                        @input="calculateBMR"
                                >
                            </div>

                            <div class="form-group">
                                <label>–í–µ—Å (–∫–≥)</label>
                                <input
                                        type="number"
                                        v-model.number="registerForm.weight"
                                        placeholder="–∫–≥"
                                        min="1"
                                        step="0.1"
                                        @input="calculateBMR"
                                >
                            </div>

                            <div class="form-group">
                                <label>–†–æ—Å—Ç (—Å–º)</label>
                                <input
                                        type="number"
                                        v-model.number="registerForm.height"
                                        placeholder="—Å–º"
                                        min="1"
                                        @input="calculateBMR"
                                >
                            </div>
                        </div>

                        <!-- –ü–æ–ª –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
                        <div class="form-row-2">
                            <div class="form-group">
                                <label>–ü–æ–ª</label>
                                <select v-model="registerForm.gender" @change="calculateBMR">
                                    <option value="">–ù–µ —É–∫–∞–∑–∞–Ω</option>
                                    <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                                    <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                                    <option value="other">–î—Ä—É–≥–æ–π</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>–ó–∞–º–µ—Ç–∫–∏</label>
                                <input
                                        type="text"
                                        v-model="registerForm.notes"
                                        placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
                                        maxlength="500"
                                >
                            </div>
                        </div>

                        <!-- –¶–µ–ª–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
                        <div class="form-row-2">
                            <div class="form-group">
                                <label>–¶–µ–ª—å</label>
                                <select v-model="registerForm.goal" @change="calculateBMR">
                                    <option value="lose">–ü–æ—Ö—É–¥–µ–Ω–∏–µ</option>
                                    <option value="maintain">–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–µ—Å–∞</option>
                                    <option value="gain">–ù–∞–±–æ—Ä –º–∞—Å—Å—ã</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</label>
                                <select v-model="registerForm.activity" @change="calculateBMR">
                                    <option value="low">–ù–∏–∑–∫–∞—è (—Å–∏–¥—è—á–∏–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏)</option>
                                    <option value="moderate">–£–º–µ—Ä–µ–Ω–Ω–∞—è (1-3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –Ω–µ–¥–µ–ª—é)</option>
                                    <option value="high">–í—ã—Å–æ–∫–∞—è (3-5 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é)</option>
                                    <option value="very-high">–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏)</option>
                                </select>
                            </div>
                        </div>

                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ BMR -->
                        <transition name="fade">
                            <div v-if="calculatedBMR" class="bmr-info">
                                <div>–í–∞—à–∞ –¥–Ω–µ–≤–Ω–∞—è –Ω–æ—Ä–º–∞ –∫–∞–ª–æ—Ä–∏–π:</div>
                                <div class="bmr-value">{{ calculatedBMR }} –∫–∫–∞–ª</div>
                                <div style="font-size: 14px; color: #666; margin-top: 5px;">
                                    –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏: {{ goalCalories }} –∫–∫–∞–ª/–¥–µ–Ω—å
                                </div>
                            </div>
                        </transition>

                        <button
                                type="submit"
                                class="submit-button"
                                :disabled="!isRegisterFormValid || isSubmitting"
                        >
                        <a href="note2.html">
                            {{ isSubmitting ? '–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞...' : '–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç' }}</a>
                            <span v-if="isSubmitting" class="loading-spinner"></span>
                        </button>
                    </form>
                </div>
            </div>
        </transition>

        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <transition name="fade">
            <div v-if="currentPage === 'home'" class="form-container">
                <h2 class="form-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ HEALS EAT</h2>
                <div v-if="isAuthenticated" style="text-align: center;">
                    <p style="color: #666; margin-bottom: 20px;">
                        –ü—Ä–∏–≤–µ—Ç, {{ currentUser?.username }}! –ì–æ—Ç–æ–≤—ã —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Å–≤–æ–∏–º –ø–∏—Ç–∞–Ω–∏–µ–º?
                    </p>
                    <button @click="navigateTo('diary')" class="submit-button" style="max-width: 300px;">
                        –û—Ç–∫—Ä—ã—Ç—å –¥–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è
                    </button>
                </div>
                <div v-else style="text-align: center;">
                    <p style="color: #666; margin-bottom: 20px;">
                        –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è –¥–ª—è –∑–¥–æ—Ä–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏
                    </p>
                    <button @click="navigateTo('auth')" class="submit-button" style="max-width: 300px;">
                        –í–æ–π—Ç–∏ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </div>
            </div>
        </transition>

        <!-- –î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è -->
        <transition name="fade">
            <div v-if="currentPage === 'diary'" class="form-container">
                <h2 class="form-title">–î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è</h2>
                <p style="text-align: center; color: #666;">
                    –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤–∞—à –¥–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è
                </p>
            </div>
        </transition>
    </div>
</div>

<script>
    const { createApp, ref, computed, reactive, onMounted } = Vue;

    createApp({
        setup() {
            // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API
            const API_BASE_URL = 'http://localhost:7000/api'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à URL

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ axios
            axios.defaults.baseURL = API_BASE_URL;
            axios.defaults.headers.common['Content-Type'] = 'application/json';

            // –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const currentPage = ref('home');
            const isSubmitting = ref(false);
            const isLoginMode = ref(true);
            const successMessage = ref('');
            const apiError = ref('');
            const isAuthenticated = ref(false);
            const currentUser = ref(null);

            const loginForm = reactive({
                login: '',
                password: ''
            });

            const registerForm = reactive({
                username: '',
                email: '',
                password: '',
                confirmPassword: '',
                age: null,
                weight: null,
                height: null,
                gender: '',
                goal: 'maintain',
                activity: 'moderate',
                notes: ''
            });

            const loginErrors = reactive({});
            const registerErrors = reactive({});
            const passwordStrength = ref(0);
            const calculatedBMR = ref(0);

            // Computed —Å–≤–æ–π—Å—Ç–≤–∞
            const passwordStrengthClass = computed(() => {
                if (passwordStrength.value < 3) return 'password-weak';
                if (passwordStrength.value < 5) return 'password-medium';
                return 'password-strong';
            });

            const passwordStrengthText = computed(() => {
                if (passwordStrength.value < 2) return '–°–ª–∞–±—ã–π';
                if (passwordStrength.value < 4) return '–°—Ä–µ–¥–Ω–∏–π';
                return '–°–∏–ª—å–Ω—ã–π';
            });

            const isRegisterFormValid = computed(() => {
                return registerForm.username &&
                    registerForm.email &&
                    registerForm.password &&
                    registerForm.confirmPassword &&
                    registerForm.password === registerForm.confirmPassword &&
                    registerForm.password.length >= 6 &&
                    Object.keys(registerErrors).length === 0;
            });

            const goalCalories = computed(() => {
                if (!calculatedBMR.value) return 0;

                const adjustments = {
                    lose: -500,
                    maintain: 0,
                    gain: 500
                };

                return calculatedBMR.value + adjustments[registerForm.goal];
            });

            // –ú–µ—Ç–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const setAuthToken = (token) => {
                if (token) {
                    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
                    localStorage.setItem('auth_token', token);
                } else {
                    delete axios.defaults.headers.common['Authorization'];
                    localStorage.removeItem('auth_token');
                }
            };

            const checkAuthStatus = async () => {
                const token = localStorage.getItem('auth_token');
                if (token) {
                    setAuthToken(token);
                    try {
                        const response = await axios.get('/auth/me');
                        if (response.data.success) {
                            isAuthenticated.value = true;
                            currentUser.value = response.data.data;
                        }
                    } catch (error) {
                        // –¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
                        handleLogout();
                    }
                }
            };

            const handleLogin = async () => {
                isSubmitting.value = true;
                apiError.value = '';

                try {
                    const response = await axios.post('/auth/login', {
                        login: loginForm.login,
                        password: loginForm.password
                    });

                    if (response.data.success) {
                        const { token, username } = response.data.data;
                        setAuthToken(token);
                        isAuthenticated.value = true;
                        currentUser.value = { username, email: loginForm.login };

                        successMessage.value = '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!';
                        setTimeout(() => {
                            navigateTo('home');
                            successMessage.value = '';
                        }, 1500);
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                    if (error.response?.data?.message) {
                        apiError.value = error.response.data.message;
                    } else {
                        apiError.value = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
                    }
                } finally {
                    isSubmitting.value = false;
                }
            };

            const handleRegistration = async () => {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
                Object.keys(registerForm).forEach(field => {
                    if (['username', 'email', 'password', 'confirmPassword'].includes(field)) {
                        validateField(field);
                    }
                });

                if (!isRegisterFormValid.value) {
                    return;
                }

                isSubmitting.value = true;
                apiError.value = '';

                try {
                    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è API —Å–æ–≥–ª–∞—Å–Ω–æ CreateUserRequestsDTO
                    const requestData = {
                        username: registerForm.username,
                        email: registerForm.email,
                        password: registerForm.password,
                        age: registerForm.age || 0,
                        weight: registerForm.weight || 0,
                        height: registerForm.height || 0,
                        gender: registerForm.gender || null,
                        goal: registerForm.goal,
                        activityLevel: registerForm.activity,
                        basalMetabolicRate: calculatedBMR.value,
                        dailyCalorieTarget: goalCalories.value,
                        notes: registerForm.notes || null
                    };

                    const response = await axios.post('/auth/register', requestData);

                    if (response.data.success) {
                        successMessage.value = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.';

                        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞
                        setTimeout(() => {
                            isLoginMode.value = true;
                            successMessage.value = '';
                            // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞
                            loginForm.login = registerForm.email;
                        }, 2000);
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                    if (error.response?.data?.message) {
                        apiError.value = error.response.data.message;
                    } else {
                        apiError.value = '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
                    }
                } finally {
                    isSubmitting.value = false;
                }
            };

            const handleLogout = async () => {
                try {
                    await axios.post('/auth/logout');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ:', error);
                } finally {
                    setAuthToken(null);
                    isAuthenticated.value = false;
                    currentUser.value = null;
                    navigateTo('home');
                }
            };

            // –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
            const validateField = (fieldName) => {
                switch(fieldName) {
                    case 'username':
                        if (registerForm.username.length < 3) {
                            registerErrors.username = '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞';
                        } else if (!/^[a-zA-Z0-9_–∞-—è–ê-–Ø]+$/.test(registerForm.username)) {
                            registerErrors.username = '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è';
                        }
                        break;

                    case 'email':
                        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!emailRegex.test(registerForm.email)) {
                            registerErrors.email = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email –∞–¥—Ä–µ—Å';
                        }
                        break;

                    case 'password':
                        if (registerForm.password.length < 6) {
                            registerErrors.password = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
                        }
                        break;

                    case 'confirmPassword':
                        if (registerForm.password !== registerForm.confirmPassword) {
                            registerErrors.confirmPassword = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                        }
                        break;
                }
            };

            const clearError = (fieldName) => {
                delete registerErrors[fieldName];
            };

            const checkPasswordStrength = () => {
                const password = registerForm.password;
                let strength = 0;

                if (password.length >= 6) strength++;
                if (password.length >= 8) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;

                passwordStrength.value = strength;
            };

            const handlePasswordInput = () => {
                clearError('password');
                checkPasswordStrength();
                validateField('password');
            };

            const calculateBMR = () => {
                if (!registerForm.weight || !registerForm.height || !registerForm.age) {
                    calculatedBMR.value = 0;
                    return;
                }

                // –§–æ—Ä–º—É–ª–∞ –ú–∏—Ñ—Ñ–ª–∏–Ω–∞-–°–∞–Ω –ñ–µ–æ—Ä–∞ (—É—Å—Ä–µ–¥–Ω–µ–Ω–Ω–∞—è)
                const bmr = 10 * registerForm.weight + 6.25 * registerForm.height - 5 * registerForm.age + 5;

                const activityMultipliers = {
                    low: 1.2,
                    moderate: 1.375,
                    high: 1.55,
                    'very-high': 1.725
                };

                calculatedBMR.value = Math.round(bmr * activityMultipliers[registerForm.activity]);
            };

            // –£—Ç–∏–ª–∏—Ç—ã
            const clearMessages = () => {
                successMessage.value = '';
                apiError.value = '';
            };

            const toggleAuthMode = () => {
                isLoginMode.value = !isLoginMode.value;
                clearMessages();
                // –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
                Object.keys(loginErrors).forEach(key => delete loginErrors[key]);
                Object.keys(registerErrors).forEach(key => delete registerErrors[key]);
            };

            const navigateTo = (page) => {
                currentPage.value = page;
                clearMessages();
            };

            // Lifecycle
            onMounted(() => {
                console.log('HEALS EAT –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ');
                checkAuthStatus();
            });

            return {
                currentPage,
                isSubmitting,
                isLoginMode,
                successMessage,
                apiError,
                isAuthenticated,
                currentUser,
                loginForm,
                registerForm,
                loginErrors,
                registerErrors,
                passwordStrengthClass,
                passwordStrengthText,
                isRegisterFormValid,
                calculatedBMR,
                goalCalories,
                navigateTo,
                toggleAuthMode,
                validateField,
                clearError,
                handlePasswordInput,
                calculateBMR,
                handleLogin,
                handleRegistration,
                handleLogout
            };
        }
    }).mount('#app');
</script>
</body>
</html>